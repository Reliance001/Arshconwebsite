<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head.ejs') %>
  <body>
    <div class="container">
      <header><%- include('./partials/nav.ejs') %></header>

      <!-- Hero Section -->
      <section class="project-hero">
        <img src="/uploads/<%= project.banner %>" alt="Project Banner" />
        <div class="hero-overlay">
          <h1><%= project.title %></h1>
          <p><%= project.category %></p>
        </div>
      </section>

      <!-- Project Details -->
      <section class="project-details">
        <div class="container">
          <!-- Meta Info -->
          <div class="project-meta">
            <p><strong>Client:</strong> <%= project.client %></p>
            <p><strong>Status:</strong> <%= project.status %></p>
            <p>
              <strong>Completion Date:</strong> <%= project.completionDate %>
            </p>
          </div>

          <!-- Description -->
          <h2>About the Project</h2>
          <p id="project-description"><%= project.description %></p>

          <!-- Construction Stages -->
          <!-- Construction Stages -->
          <% if (project.stages) { %>
          <div class="stages mt-5">
            <h2 class="mb-4">Construction Stages</h2>

            <% // Define all stages in one array with display names const
            stagesList = [ { key: "landClearing", label: "Land Clearing" }, {
            key: "foundation", label: "Foundation" }, { key: "blockwork", label:
            "Blockwork" }, { key: "roofing", label: "Roofing" }, { key:
            "finishing", label: "Finishing" }, { key: "livingRoom", label:
            "Living Room" }, { key: "kitchen", label: "Kitchen" }, { key:
            "toilet", label: "Toilet" } ]; %> <% stagesList.forEach((stage,
            index) => { const stageData = project.stages[stage.key]; if
            (stageData && (stageData.images?.length || stageData.text)) { %>
            <div class="stage mb-5">
              <h3><%= index + 1 %>. <%= stage.label %></h3>

              <% if (stageData.images?.length) { %>
              <div
                id="<%= stage.key %>Carousel"
                class="carousel slide"
                data-bs-ride="carousel"
              >
                <div class="carousel-inner">
                  <% stageData.images.forEach((img, i) => { %>
                  <div class="carousel-item <%= i === 0 ? 'active' : '' %>">
                    <img
                      src="/uploads/<%= img %>"
                      class="d-block w-100 rounded shadow-sm"
                      alt="<%= stage.label %>"
                    />
                  </div>
                  <% }) %>
                </div>
                <button
                  class="carousel-control-prev"
                  type="button"
                  data-bs-target="#<%= stage.key %>Carousel"
                  data-bs-slide="prev"
                >
                  <span class="carousel-control-prev-icon"></span>
                </button>
                <button
                  class="carousel-control-next"
                  type="button"
                  data-bs-target="#<%= stage.key %>Carousel"
                  data-bs-slide="next"
                >
                  <span class="carousel-control-next-icon"></span>
                </button>
              </div>
              <% } %> <% if (stageData.text) { %>
              <p class="mt-3 features"><%= stageData.text %></p>
              <% } %>
            </div>
            <% } }) %>
          </div>
          <% } %>

          <!-- Testimonial -->
          <h3>Client Testimonials</h3>
          <div class="testimonial">
            <p><%= project.testimonial?.text || '' %></p>
            <strong><%= project.testimonial?.author || '' %></strong>
          </div>

          <!-- Call to Action -->
          <div class="cta mb-2">
            <h2>Interested in a Similar Project?</h2>
            <p>Contact us to discuss your next big idea!</p>
            <a href="/Contact" class="pD-btn">Get in Touch</a>
          </div>
        </div>
      </section>

      <%- include('./partials/footer.ejs') %>
    </div>

    <!-- Bootstrap JS (needed for carousel) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
